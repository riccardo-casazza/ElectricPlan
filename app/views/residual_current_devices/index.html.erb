<p style="color: green"><%= notice %></p>

<% content_for :title, "Residual current devices" %>

<div style="margin-bottom: 1rem;">
  <%= link_to "â† Back to Home", root_path %>
</div>

<h1>Residual Current Devices</h1>

<div style="margin: 1.5rem 0;">
  <%= link_to "New RCD", new_residual_current_device_path, class: "button-primary" %>
</div>

<% if @new_residual_current_device %>
  <%= form_with(model: @new_residual_current_device, html: { id: dom_id(@new_residual_current_device, :form) }) do |form| %>
  <% end %>
<% end %>

<table class="crud-table">
  <thead>
    <tr>
      <th>Name</th>
      <th>Panel</th>
      <th>Row</th>
      <th>Position</th>
      <th>Max Current (A)</th>
      <th>Type</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <% if @new_residual_current_device %>
      <%= render "residual_current_device_row", residual_current_device: @new_residual_current_device, editing: true %>
    <% end %>

    <% @residual_current_devices.each do |rcd| %>
      <% is_editing = @new_residual_current_device&.persisted? && @new_residual_current_device.id == rcd.id %>
      <% unless is_editing %>
        <%= render "residual_current_device_row", residual_current_device: rcd, editing: false %>
      <% end %>
    <% end %>
  </tbody>
</table>

<% if @residual_current_devices.empty? %>
  <p style="margin-top: 2rem; color: #666;">No residual current devices yet. Click "New RCD" to add one.</p>
<% end %>
